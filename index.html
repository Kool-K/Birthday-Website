<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>A Surprise For You!</title>
    <!-- Favicon Placeholder -->
    <link
      id="favicon"
      rel="icon"
      href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸŽ‚</text></svg>"
    />

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400..900;1,400..900&family=Poppins:wght@300;400;500;600&display=swap"
      rel="stylesheet"
    />

    <!-- Font Awesome for Icons -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />

    <style>
      body {
        font-family: "Poppins", sans-serif;
        overflow-x: hidden;
        background-color: #fdf2f8; /* Fallback color */

        background-image: url("./assets/images/main-background.png"); /* Your new image! */
        background-size: cover;
        background-position: center;
        background-attachment: fixed; /* Keeps the background still while scrolling */
      }
      
      /* --- NEW RIPPLE EFFECT STYLES FOR MYSTERY CONTAINER --- */
      #mystery-container {
        background-color: #0c1445; /* Deep sea blue */
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        overflow: hidden; /* Important for canvas */
      }

      #ripple-canvas {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 0;
      }
      
      /* New contrasting text and button styles */
      #mystery-container h2 {
        color: #e0f2fe; /* Light sky blue, like moonlight on water */
        text-shadow: 0 2px 8px rgba(0,0,0,0.5);
        z-index: 1;
      }

      #mystery-container #mystery-btn {
        background-color: #38bdf8; /* A vibrant sky blue */
        color: #0c1445; /* Deep blue text */
        box-shadow: 0 0 20px rgba(56, 189, 248, 0.6);
        z-index: 1;
      }
      #mystery-container #mystery-btn:hover {
        background-color: #7dd3fc;
      }


      #wishes-wall {
        background-image: url("./assets/images/window-heart.jpg");
        background-size: cover;
        background-position: center;
        background-attachment: fixed;
        position: relative;
        overflow: hidden;
        width: 100vw;
        margin-left: calc(50% - 50vw);
        padding: 4rem 2rem;
      }

      #wishes-wall::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: rgba(0, 0, 0, 0.4);
        z-index: 1;
      }

      #wishes-wall h2,
      #wishes-wall p {
        color: white;
        text-shadow: 0px 2px 8px rgba(0, 0, 0, 0.7);
        transform: translateZ(0);
      }

      #wishes-wall > * {
        position: relative;
        z-index: 2;
      }

      .font-display {
        font-family: "Playfair Display", serif;
      }

      ::-webkit-scrollbar {
        width: 0;
        background: transparent;
      }
      
      .memory-card {
        background: rgba(255, 255, 255, 0.7);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 0.75rem;
        box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1),
          0 10px 10px -5px rgba(0, 0, 0, 0.04);
        overflow: hidden;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
      }
      .memory-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 20px 30px -10px rgba(0, 0, 0, 0.2);
      }
      .memory-card .image-container {
        overflow: hidden;
      }
      .memory-card img {
        transition: transform 0.5s ease;
      }
      .memory-card:hover img {
        transform: scale(1.1);
      }

      .typewriter-cursor::after {
        content: "|";
        animation: blink 1s step-end infinite;
      }
      @keyframes blink {
        from, to { color: transparent; }
        50% { color: #581c87; }
      }
      
      #heart-container {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 3; /* Above the overlay */
      }

      .pulsating-heart {
        position: absolute;
        cursor: pointer;
        color: #ff8fab; /* A soft, warm pink that contrasts well */
        transition: transform 0.3s ease, color 0.3s ease;
        animation: pulse 2.5s infinite ease-in-out;
        filter: drop-shadow(0 0 10px rgba(255, 136, 171, 0.8));
      }

      .pulsating-heart:hover {
        transform: scale(1.2);
        color: #fb7185; /* Brighter on hover */
      }

      @keyframes pulse {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.1); }
      }

      .wish-card {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) scale(0.8);
        background: #fff;
        color: #4c1d95;
        padding: 2rem;
        border-radius: 1rem;
        box-shadow: 0 20px 40px rgba(0,0,0,0.25);
        max-width: 90vw;
        width: 400px;
        text-align: center;
        z-index: 100;
        opacity: 0;
        pointer-events: none;
        transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275), opacity 0.4s ease;
      }

      .wish-card.visible {
        transform: translate(-50%, -50%) scale(1);
        opacity: 1;
        pointer-events: auto;
      }
      
      .wish-card-text {
          font-family: 'Playfair Display', serif;
          font-size: 1.75rem;
          line-height: 1.4;
          margin-bottom: 1.5rem;
      }

      .wish-card-close {
          position: absolute;
          top: 10px;
          right: 10px;
          background: #f1f5f9;
          color: #64748b;
          border: none;
          width: 30px;
          height: 30px;
          border-radius: 50%;
          font-size: 1rem;
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          transition: background-color 0.2s, color 0.2s;
      }
      .wish-card-close:hover {
          background-color: #e2e8f0;
          color: #1e293b;
      }

      .wish-overlay {
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background: rgba(0,0,0,0.5);
          backdrop-filter: blur(5px);
          z-index: 99;
          opacity: 0;
          pointer-events: none;
          transition: opacity 0.4s ease;
      }
      .wish-overlay.visible {
          opacity: 1;
          pointer-events: auto;
      }

    </style>
  </head>
  <body class="text-gray-800">
    <!-- Music Player & Toggle -->
    <audio id="bg-music" loop></audio>
    <button id="music-toggle" class="fixed bottom-5 right-5 z-50 bg-purple-500 text-white w-12 h-12 rounded-full shadow-lg flex items-center justify-center text-xl hover:bg-purple-600 transition-colors">
      <i id="music-icon" class="fas fa-volume-mute"></i>
    </button>

    <!-- Mystery Screen -->
    <div id="mystery-container" class="fixed inset-0 z-50 flex flex-col items-center justify-center transition-opacity duration-1000">
      <!-- The new canvas for our ripple effect -->
      <canvas id="ripple-canvas"></canvas>
      <div class="text-center p-4 relative">
        <h2 id="mystery-text" class="text-2xl md:text-4xl font-display mb-6">A special surprise is waiting...</h2>
        <button id="mystery-btn" class="font-bold text-lg px-8 py-4 rounded-full shadow-lg hover:shadow-2xl transform hover:scale-105 transition-all duration-300 ease-in-out">Click to Begin</button>
      </div>
    </div>

    <!-- Main Content -->
    <main id="content" class="opacity-0 min-h-screen p-4 md:p-8 lg:p-12 max-w-5xl mx-auto">
      <header class="text-center min-h-screen flex flex-col justify-center items-center">
        <h1 id="main-title" class="font-display text-5xl md:text-8xl text-purple-800 mb-4">Happy Birthday, Sister!</h1>
        <p id="main-subtitle" class="text-lg md:text-2xl text-gray-600 mb-12">Let's take a journey through some beautiful moments.</p>
        <div class="animate-bounce text-purple-600 text-4xl"><i class="fas fa-arrow-down"></i></div>
      </header>

      <!-- Memory Lane Section -->
      <section class="my-24">
        <h2 class="text-center font-display text-5xl text-purple-800 mb-16">Memory Lane</h2>
        <div id="memories-grid" class="grid grid-cols-1 md:grid-cols-2 gap-8 md:gap-12"></div>
      </section>

      <!-- NEW Interactive Wishes Wall Section -->
      <section id="wishes-wall" class="my-24 min-h-screen flex flex-col justify-center items-center relative">
        <h2 class="text-center font-display text-5xl mb-8 z-10">A Sky Full of Wishes</h2>
        <p class="text-lg max-w-2xl text-center z-10 mb-8">Tap on the glowing hearts to reveal a special wish just for you...</p>
        <div id="heart-container"></div>
      </section>
      
      <div id="wish-card-overlay" class="wish-overlay"></div>
      <div id="wish-card" class="wish-card">
          <button id="wish-card-close" class="wish-card-close">&times;</button>
          <p id="wish-card-text"></p>
      </div>


      <!-- Final Message Section -->
      <section id="message-box" class="bg-white/60 backdrop-blur-lg rounded-2xl shadow-2xl p-8 md:p-12 my-24 border border-white/50 max-w-3xl mx-auto">
        <div id="typewriter-container"></div>
        <div class="text-right mt-8">
          <p id="signature" class="font-display text-4xl text-purple-800 opacity-0"></p>
          <p id="from" class="text-2xl text-gray-600 mt-2 opacity-0"></p>
        </div>
      </section>

      <footer class="text-center py-8 mt-12 text-gray-500">
        <p>Crafted with <i class="fas fa-heart text-red-500 animate-pulse"></i> by Ketaki for her sister.</p>
        <p id="music-credit" class="text-sm mt-2"></p>
      </footer>
    </main>

    <!-- Confetti Canvas -->
    <canvas id="confetti-canvas" class="fixed top-0 left-0 w-full h-full pointer-events-none z-50"></canvas>

    <!-- GSAP + Tone.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/TextPlugin.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.77/Tone.js"></script>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        gsap.registerPlugin(ScrollTrigger, TextPlugin);

        const config = {
          name: "Shalmali",
          faviconEmoji: "ðŸŽ‚",
          greeting: "Happy Birthday,",
          subtitle: "Let's take a journey through some beautiful moments.",
          audioSrc: "./assets/audio/birthday-song.mp3",
          audioArtist: "WaveMaster",
          audioSource: "Pixabay",
          photos: [
            { url: "./assets/images/photo1.png", caption: "That unforgettable camping day!" },
            { url: "./assets/images/photo2.png", caption: "So proud of you on your graduation day." },
            { url: "./assets/images/photo3.png", caption: "We have always been the best at making silly faces." },
            { url: "./assets/images/photo4.png", caption: "The lazy summer season is always better with you " },
          ],
          message: {
            p1: "On your special day, I just wanted to remind you of the incredible light you bring into the world. Your kindness, laughter, and strength inspire everyone lucky enough to know you.",
            p2: "May this new chapter be filled with endless joy, exciting adventures, and all the success you deserve. Never stop dreaming and shining bright!",
            signature: "With all my love,",
            from: "Ketaki Kulkarni",
          },
          wishes: [
            "May your birthday be filled with as much joy as you bring to everyone else!",
            "Wishing you a year ahead that's as bright and wonderful as your smile.",
            "Hope your special day brings you all that your heart desires!",
            "Cheers to you for another trip around the sun! May it be your best one yet.",
            "Sending you the biggest hugs and best wishes on your birthday!",
            "May you continue to inspire everyone around you.",
            "Wishing you health, happiness, and success in the coming year.",
          ],
        };

        // JS Element References
        const mysteryBtn = document.getElementById("mystery-btn");
        const mysteryContainer = document.getElementById("mystery-container");
        const content = document.getElementById("content");
        const musicToggle = document.getElementById("music-toggle");
        const musicIcon = document.getElementById("music-icon");
        const bgMusic = document.getElementById("bg-music");
        const musicCredit = document.getElementById("music-credit");
        const confettiCanvas = document.getElementById("confetti-canvas");

        // Apply Customization
        document.title = `ðŸŽ‚ ${config.name}'s Birthday Journey!`;
        document.getElementById("favicon").href = `data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>${config.faviconEmoji}</text></svg>`;
        document.getElementById("mystery-text").textContent = `A special surprise for ${config.name} is waiting...`;
        document.getElementById("main-title").textContent = `${config.greeting} ${config.name}!`;
        document.getElementById("main-subtitle").textContent = config.subtitle;

        if (config.audioSrc) {
          bgMusic.src = config.audioSrc;
          if (config.audioArtist && config.audioSource) {
            musicCredit.innerHTML = `Music by ${config.audioArtist} from ${config.audioSource}`;
          }
        }

        const memoriesGrid = document.getElementById("memories-grid");
        config.photos.forEach((photo) => {
          const memoryCard = document.createElement("div");
          memoryCard.className = "memory-card";
          memoryCard.innerHTML = `
            <div class="image-container aspect-[4/3]">
                <img src="${photo.url}" alt="Memory" class="w-full h-full object-cover" onerror="this.onerror=null;this.src='https://placehold.co/800x600/e2e8f0/475569?text=Image+Not+Found';">
            </div>
            <div class="p-4 text-center">
                <p class="font-display text-purple-800 text-lg">${photo.caption}</p>
            </div>`;
          memoriesGrid.appendChild(memoryCard);
        });

        let musicPlaying = false;
        musicToggle.addEventListener("click", () => {
          if (!config.audioSrc) return;
          if (musicPlaying) {
            bgMusic.pause();
            musicIcon.className = "fas fa-volume-mute";
          } else {
            bgMusic.play().catch((e) => console.log("Audio play failed."));
            musicIcon.className = "fas fa-volume-up";
          }
          musicPlaying = !musicPlaying;
        });
        
        // Main Reveal Animation
        mysteryBtn.addEventListener("click", () => {
          gsap.to(mysteryContainer, { opacity: 0, duration: 1, ease: "power2.inOut", onComplete: () => {
              mysteryContainer.style.display = "none";
              launchConfetti();
              if (!musicPlaying && musicToggle && config.audioSrc) musicToggle.click();
            },
          });
          gsap.to(content, { opacity: 1, duration: 1, delay: 0.5 });
          const tl = gsap.timeline({ delay: 0.8 });
          tl.from("#main-title", { y: 100, opacity: 0, duration: 1, ease: "power3.out" })
            .from("#main-subtitle", { y: 50, opacity: 0, duration: 0.8, ease: "power3.out" }, "-=0.7")
            .from(".fa-arrow-down", { y: -20, opacity: 0, duration: 1, ease: "elastic.out(1, 0.5)" }, "-=0.5");
        });

        // =================================================================
        // ======== UPGRADED OCEAN SCENE SCRIPT ============================
        // =================================================================
        const rippleCanvas = document.getElementById('ripple-canvas');
        const ctxRipple = rippleCanvas.getContext('2d');
        let ripples = [];
        let bubbles = [];
        let fishSchool = [];
        let whale = {};

        function resizeCanvas() {
            rippleCanvas.width = window.innerWidth;
            rippleCanvas.height = window.innerHeight;
        }
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);
        
        // --- Create Sea Life ---
        function createSeaLife() {
            // Create a school of fish
            for(let i = 0; i < 15; i++) {
                fishSchool.push({
                    x: Math.random() * rippleCanvas.width,
                    y: Math.random() * rippleCanvas.height,
                    size: Math.random() * 4 + 4, // Slightly larger fish
                    speed: Math.random() * 0.5 + 0.2
                });
            }
            // Create bubbles
            for(let i = 0; i < 40; i++) {
                bubbles.push({
                    x: Math.random() * rippleCanvas.width,
                    y: rippleCanvas.height + Math.random() * 100,
                    radius: Math.random() * 3 + 1,
                    speed: Math.random() * 1 + 0.5
                });
            }
            // Create the whale
            whale = {
                x: -300,
                y: rippleCanvas.height * 0.7,
                size: 250,
                speed: 0.1,
                visible: false
            };
            // Make the whale appear occasionally
            setInterval(() => {
                if (!whale.visible) {
                    whale.visible = true;
                    whale.y = rippleCanvas.height * (Math.random() * 0.4 + 0.5); // Random depth
                    whale.x = -whale.size;
                }
            }, 20000); // Appear every 20 seconds
        }

        mysteryContainer.addEventListener('mousemove', function(e) {
            ripples.push({
                x: e.clientX, y: e.clientY, radius: 0, opacity: 1,
                speed: Math.random() * 0.5 + 0.5 
            });
        });

        function animateScene() {
            ctxRipple.clearRect(0, 0, rippleCanvas.width, rippleCanvas.height);
            
            // 1. Draw Whale (background)
            if (whale.visible) {
                whale.x += whale.speed;
                ctxRipple.fillStyle = 'rgba(12, 38, 112, 0.4)'; // Darker silhouette
                // Simple whale shape
                ctxRipple.beginPath();
                ctxRipple.moveTo(whale.x, whale.y);
                ctxRipple.quadraticCurveTo(whale.x + whale.size * 0.4, whale.y - whale.size * 0.3, whale.x + whale.size * 0.8, whale.y);
                ctxRipple.quadraticCurveTo(whale.x + whale.size, whale.y + whale.size * 0.1, whale.x + whale.size * 1.1, whale.y + whale.size * 0.05);
                ctxRipple.quadraticCurveTo(whale.x + whale.size, whale.y + whale.size * 0.15, whale.x + whale.size * 0.8, whale.y + whale.size * 0.2);
                ctxRipple.quadraticCurveTo(whale.x + whale.size * 0.4, whale.y + whale.size * 0.3, whale.x, whale.y);
                ctxRipple.closePath();
                ctxRipple.fill();
                if (whale.x > rippleCanvas.width + whale.size) whale.visible = false;
            }

            // 2. Draw Fish with proper shapes
            fishSchool.forEach(f => {
                f.x += f.speed;
                if (f.x > rippleCanvas.width + f.size * 2) {
                    f.x = -f.size * 2;
                    f.y = Math.random() * rippleCanvas.height; // Re-enter at a new height
                }
                
                ctxRipple.fillStyle = `rgba(125, 211, 252, 0.7)`; // Brighter, more visible color

                // Body (ellipse)
                ctxRipple.beginPath();
                ctxRipple.ellipse(f.x, f.y, f.size * 1.5, f.size, 0, 0, 2 * Math.PI);
                ctxRipple.fill();

                // Tail (triangle)
                ctxRipple.beginPath();
                ctxRipple.moveTo(f.x - f.size * 1.2, f.y); // Point where tail meets body
                ctxRipple.lineTo(f.x - f.size * 2.5, f.y - f.size); // Top of tail
                ctxRipple.lineTo(f.x - f.size * 2.5, f.y + f.size); // Bottom of tail
                ctxRipple.closePath();
                ctxRipple.fill();
            });

            // 3. Draw Bubbles
            bubbles.forEach(b => {
                b.y -= b.speed;
                b.x += Math.sin(b.y / 20) * 0.5; // Gentle sway
                if (b.y < -b.radius) {
                    b.y = rippleCanvas.height + b.radius;
                    b.x = Math.random() * rippleCanvas.width;
                }
                ctxRipple.strokeStyle = `rgba(125, 211, 252, 0.5)`;
                ctxRipple.lineWidth = 1;
                ctxRipple.beginPath();
                ctxRipple.arc(b.x, b.y, b.radius, 0, Math.PI * 2);
                ctxRipple.stroke();
            });

            // 4. Draw Ripples (foreground)
            ripples.forEach((r, i) => {
                r.radius += r.speed;
                r.opacity -= 0.02;
                if (r.opacity <= 0) {
                    ripples.splice(i, 1);
                } else {
                    ctxRipple.strokeStyle = `rgba(56, 189, 248, ${r.opacity})`;
                    ctxRipple.lineWidth = 2;
                    ctxRipple.beginPath();
                    ctxRipple.arc(r.x, r.y, r.radius, 0, Math.PI * 2);
                    ctxRipple.stroke();
                }
            });
            
            requestAnimationFrame(animateScene);
        }
        createSeaLife();
        animateScene();


        //Scroll-Based Animations
        gsap.utils.toArray(".memory-card").forEach((item) => {
          gsap.from(item, { opacity: 0, y: 100, duration: 1, ease: "power3.out", scrollTrigger: {
              trigger: item,
              start: "top 85%",
              toggleActions: "play none none none",
            },
          });
        });

        // Interactive Wishes Wall Logic
        const heartContainer = document.getElementById("heart-container");
        const wishCard = document.getElementById("wish-card");
        const wishCardText = document.getElementById("wish-card-text");
        const wishCardClose = document.getElementById("wish-card-close");
        const wishOverlay = document.getElementById("wish-card-overlay");
        const popSound = new Tone.MembraneSynth().toDestination();
        const numberOfHearts = 15;
        let lastWishIndex = -1;

        function showWish() {
            if (Tone.context.state !== "running") { Tone.context.resume(); }
            popSound.triggerAttackRelease("C4", "8n");
            let newWishIndex;
            do { newWishIndex = Math.floor(Math.random() * config.wishes.length); } while (newWishIndex === lastWishIndex);
            lastWishIndex = newWishIndex;
            wishCardText.textContent = config.wishes[newWishIndex];
            wishCard.classList.add("visible");
            wishOverlay.classList.add("visible");
        }

        function hideWish() {
            wishCard.classList.remove("visible");
            wishOverlay.classList.remove("visible");
        }

        function createPulsatingHearts() {
            const heartContainerWidth = heartContainer.offsetWidth;
            for (let i = 0; i < numberOfHearts; i++) {
                const heart = document.createElement("div");
                heart.className = "pulsating-heart";
                heart.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-full h-full"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>`;
                const size = gsap.utils.random(30, 60);
                heart.style.width = `${size}px`;
                heart.style.height = `${size}px`;
                heart.style.top = `${gsap.utils.random(10, 90)}%`;
                
                // New safe horizontal positioning to prevent overflow on mobile
                const padding = 15; // A small pixel padding from the edges
                const maxLeft = heartContainerWidth - size - padding;
                const minLeft = padding;
                heart.style.left = `${gsap.utils.random(minLeft, maxLeft)}px`;

                heart.style.animationDelay = `${gsap.utils.random(0, 2.5)}s`;
                heart.addEventListener("click", (e) => {
                    e.stopPropagation();
                    gsap.to(heart, { scale: 1.5, opacity: 0, duration: 0.3, ease: "power2.in", onComplete: () => { gsap.set(heart, { scale: 1, opacity: 1 }); } });
                    showWish();
                });
                heartContainer.appendChild(heart);
            }
        }
        
        wishCardClose.addEventListener('click', hideWish);
        wishOverlay.addEventListener('click', hideWish);

        ScrollTrigger.create({
            trigger: "#wishes-wall", start: "top 60%",
            onEnter: () => { if (heartContainer.children.length === 0) { createPulsatingHearts(); } },
            once: true
        });

        // Typewriter Animation
        const typewriterContainer = document.getElementById("typewriter-container");
        const messageLines = [`Dearest ${config.name},`, config.message.p1, config.message.p2];
        ScrollTrigger.create({
          trigger: "#message-box", start: "top 70%",
          onEnter: () => {
            let masterTl = gsap.timeline();
            messageLines.forEach((line) => {
              const p = document.createElement("p");
              p.className = "text-xl leading-relaxed mb-6 typewriter-cursor";
              typewriterContainer.appendChild(p);
              masterTl.to(p, { duration: line.length * 0.05, text: { value: line }, ease: "none", onComplete: () => p.classList.remove("typewriter-cursor") });
            });
            masterTl
              .to("#signature", { text: config.message.signature, duration: 1, opacity: 1 })
              .to("#from", { text: config.message.from, duration: 1, opacity: 1 }, "-=0.5");
          },
          once: true,
        });

        //Confetti Logic
        const ctxConfetti = confettiCanvas.getContext("2d");
        function launchConfetti() { createConfettiBurst(window.innerWidth / 2, window.innerHeight / 2, 300, true); }
        function createConfettiBurst(startX, startY, particleCount, isFullScreen) {
          const particles = [];
          const colors = ["#a855f7", "#d946ef", "#ec4899", "#fef08a", "#ffffff"];
          for (let i = 0; i < particleCount; i++) {
            const angle = Math.random() * Math.PI * 2;
            const velocity = Math.random() * (isFullScreen ? 8 : 4) + 2;
            particles.push({ x: startX, y: startY, color: colors[Math.floor(Math.random() * colors.length)], radius: Math.random() * 4 + 2, vx: Math.cos(angle) * velocity, vy: Math.sin(angle) * velocity, gravity: 0.1, opacity: 1, fade: Math.random() * 0.02 + 0.01 });
          }
          animateConfetti(particles);
        }
        function animateConfetti(particles) {
          confettiCanvas.width = window.innerWidth;
          confettiCanvas.height = window.innerHeight;
          function update() {
            ctxConfetti.clearRect(0, 0, confettiCanvas.width, confettiCanvas.height);
            particles.forEach((p, index) => {
              p.vy += p.gravity; p.x += p.vx; p.y += p.vy; p.opacity -= p.fade;
              if (p.opacity <= 0) particles.splice(index, 1);
              else {
                ctxConfetti.globalAlpha = p.opacity; ctxConfetti.fillStyle = p.color;
                ctxConfetti.beginPath(); ctxConfetti.arc(p.x, p.y, p.radius, 0, Math.PI * 2); ctxConfetti.fill();
              }
            });
            if (particles.length > 0) requestAnimationFrame(update);
          }
          update();
        }
        window.addEventListener("resize", () => {
          confettiCanvas.width = window.innerWidth;
          confettiCanvas.height = window.innerHeight;
        });
      });
    </script>
  </body>
</html>
