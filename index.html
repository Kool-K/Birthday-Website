<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A Surprise For You!</title>
    <!-- Favicon Placeholder -->
    <link id="favicon" rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸŽ‚</text></svg>">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400..900;1,400..900&family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
    
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        body { font-family: 'Poppins', sans-serif; overflow-x: hidden; background-color: #fdf2f8; }
        .font-display { font-family: 'Playfair Display', serif; }

        .animated-gradient {
            background: linear-gradient(300deg, #fdf2f8, #f5d0fe, #dbeafe, #fbcfe8);
            background-size: 200% 200%;
            animation: gradient-animation 25s ease infinite;
        }
        @keyframes gradient-animation {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        ::-webkit-scrollbar { width: 0; background: transparent; }

        /* --- Memory Card Styles --- */
        .memory-card {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 0.75rem;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            overflow: hidden;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .memory-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 30px -10px rgba(0, 0, 0, 0.2);
        }
        .memory-card .image-container {
            overflow: hidden;
        }
        .memory-card img {
            transition: transform 0.5s ease;
        }
        .memory-card:hover img {
            transform: scale(1.1);
        }

        /* Floating particles in the background */
        .particle {
            position: fixed;
            border-radius: 50%;
            pointer-events: none;
            background: white;
            animation: float-up 15s infinite linear;
        }
        @keyframes float-up {
            to {
                transform: translateY(-100vh) rotate(360deg);
                opacity: 0;
            }
        }

        /* Wish notes styling */
        .wish-note {
            position: absolute;
            padding: 1rem 1.5rem;
            background: rgba(255, 255, 255, 0.95); /* More opaque */
            backdrop-filter: blur(8px);
            border-radius: 12px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
            font-style: italic;
            font-weight: 500; /* Slightly bolder */
            color: #4c1d95;
            text-shadow: 0 1px 2px rgba(0,0,0,0.05);
            opacity: 0;
            pointer-events: none;
            max-width: 90vw;
            white-space: nowrap;
        }

        /* Animated Decorations */
        .decoration {
            position: fixed;
            bottom: -100px;
            pointer-events: none;
            opacity: 0.5;
            animation: drift-up 20s infinite linear;
            z-index: -1;
            cursor: pointer;
        }
        @keyframes drift-up {
            to {
                transform: translateY(-120vh) rotate(360deg);
                opacity: 0;
            }
        }

        /* Typewriter effect */
        .typewriter-cursor::after {
            content: '|';
            animation: blink 1s step-end infinite;
        }
        @keyframes blink {
            from, to { color: transparent }
            50% { color: #581c87; }
        }
    </style>
</head>
<body class="animated-gradient text-gray-800">

    <!-- Background Decorations & Particles -->
    <div id="particle-container"></div>
    <div id="decoration-container"></div>

    <!-- Music Player -->
    <audio id="bg-music" loop></audio>

    <!-- Music Toggle -->
    <button id="music-toggle" class="fixed bottom-5 right-5 z-50 bg-purple-500 text-white w-12 h-12 rounded-full shadow-lg flex items-center justify-center text-xl hover:bg-purple-600 transition-colors">
        <i id="music-icon" class="fas fa-volume-mute"></i>
    </button>

    <!-- Mystery Screen -->
    <div id="mystery-container" class="fixed inset-0 z-50 flex flex-col items-center justify-center transition-opacity duration-1000 bg-pink-50">
        <div class="text-center p-4">
            <h2 id="mystery-text" class="text-2xl md:text-4xl font-display text-gray-700 mb-6">A special surprise is waiting...</h2>
            <button id="mystery-btn" class="bg-purple-500 text-white font-bold text-lg px-8 py-4 rounded-full shadow-lg hover:shadow-2xl transform hover:scale-105 transition-all duration-300 ease-in-out">
                Click to Begin
            </button>
        </div>
    </div>

    <!-- Main Content -->
    <main id="content" class="opacity-0 min-h-screen p-4 md:p-8 lg:p-12 max-w-5xl mx-auto">
        
        <header class="text-center min-h-screen flex flex-col justify-center items-center">
            <h1 id="main-title" class="font-display text-5xl md:text-8xl text-purple-800 mb-4">Happy Birthday, Sister!</h1>
            <p id="main-subtitle" class="text-lg md:text-2xl text-gray-600 mb-12">Let's take a journey through some beautiful moments.</p>
            <div class="animate-bounce text-purple-600 text-4xl">
                <i class="fas fa-arrow-down"></i>
            </div>
        </header>

        <!-- Memory Lane Section -->
        <section class="my-24">
            <h2 class="text-center font-display text-5xl text-purple-800 mb-16">Memory Lane</h2>
            <div id="memories-grid" class="grid grid-cols-1 md:grid-cols-2 gap-8 md:gap-12">
                <!-- Photo cards will be injected here by JavaScript -->
            </div>
        </section>

        <!-- Wishes Wall Section -->
        <section id="wishes-wall" class="my-24 min-h-screen flex flex-col justify-center items-center relative overflow-hidden">
             <h2 class="text-center font-display text-5xl text-purple-800 mb-8 z-10">A Shower of Wishes</h2>
             <p class="text-lg text-gray-600 max-w-2xl text-center z-10">Sending you all the happiness in the world, today and always. Here are just a few wishes for you...</p>
        </section>

        <!-- Final Message Section -->
        <section id="message-box" class="bg-white/60 backdrop-blur-lg rounded-2xl shadow-2xl p-8 md:p-12 my-24 border border-white/50 max-w-3xl mx-auto">
            <div id="typewriter-container"></div>
            <div class="text-right mt-8">
                <p id="signature" class="font-display text-4xl text-purple-800 opacity-0"></p>
                <p id="from" class="text-2xl text-gray-600 mt-2 opacity-0"></p>
            </div>
        </section>

        <footer class="text-center py-8 mt-12 text-gray-500">
            <p>Crafted with <i class="fas fa-heart text-red-500 animate-pulse"></i> by Ketaki for her sister.</p>
            <p id="music-credit" class="text-sm mt-2"></p>
        </footer>
    </main>

    <!-- Confetti Canvas -->
    <canvas id="confetti-canvas" class="fixed top-0 left-0 w-full h-full pointer-events-none z-50"></canvas>

    <!-- GSAP + Tone.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/TextPlugin.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.77/Tone.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            gsap.registerPlugin(ScrollTrigger, TextPlugin);

            // =================================================================
            // ======== CUSTOMIZATION SECTION: Edit these values! ========
            // =================================================================
            const config = {
                name: "Shalmali",
                faviconEmoji: "ðŸŽ‚",
                greeting: "Happy Birthday,",
                subtitle: "Let's take a journey through some beautiful moments.",
                
                audioSrc: "./assets/audio/birthday-song.mp3",
                audioArtist: "WaveMaster",
                audioSource: "Pixabay",
                
                photos: [
                    { url: './assets/images/photo1.png', caption: 'That unforgettable camping day!' },
                    { url: './assets/images/photo2.png', caption: 'So proud of you on your graduation day.' },
                    { url: './assets/images/photo3.png', caption: 'We have always been the best at making silly faces.' },
                    { url: './assets/images/photo4.png', caption: 'The lazy summer season is always better with you ' },
                ],

                message: {
                    p1: "On your special day, I just wanted to remind you of the incredible light you bring into the world. Your kindness, laughter, and strength inspire everyone lucky enough to know you.",
                    p2: "May this new chapter be filled with endless joy, exciting adventures, and all the success you deserve. Never stop dreaming and shining bright!",
                    signature: "With all my love,",
                    from: "Ketaki Kulkarni"
                },
                
                wishes: [
                    "May your birthday be filled with as much joy as you bring to everyone else!",
                    "Wishing you a year ahead that's as bright and wonderful as your smile.",
                    "Hope your special day brings you all that your heart desires!",
                    "Cheers to you for another trip around the sun! May it be your best one yet.",
                    "Sending you the biggest hugs and best wishes on your birthday!",
                    "May you continue to inspire everyone around you.",
                    "Wishing you health, happiness, and success in the coming year."
                ]
            };
            // =================================================================


            // JS Element References
            const mysteryBtn = document.getElementById('mystery-btn');
            const mysteryContainer = document.getElementById('mystery-container');
            const content = document.getElementById('content');
            const musicToggle = document.getElementById('music-toggle');
            const musicIcon = document.getElementById('music-icon');
            const bgMusic = document.getElementById('bg-music');
            const musicCredit = document.getElementById('music-credit');
            const confettiCanvas = document.getElementById('confetti-canvas');
            const particleContainer = document.getElementById('particle-container');
            const decorationContainer = document.getElementById('decoration-container');

            // Apply Customization from config.json
            document.title = `ðŸŽ‚ ${config.name}'s Birthday Journey!`;
            document.getElementById('favicon').href = `data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>${config.faviconEmoji}</text></svg>`;
            document.getElementById('mystery-text').textContent = `A special surprise for ${config.name} is waiting...`;
            document.getElementById('main-title').textContent = `${config.greeting} ${config.name}!`;
            document.getElementById('main-subtitle').textContent = config.subtitle;

            if (config.audioSrc) {
                bgMusic.src = config.audioSrc;
                if (config.audioArtist && config.audioSource) {
                    musicCredit.innerHTML = `Music by ${config.audioArtist} from ${config.audioSource}`;
                }
            }
            
            const memoriesGrid = document.getElementById('memories-grid');
            config.photos.forEach((photo) => {
                const memoryCard = document.createElement('div');
                memoryCard.className = 'memory-card';
                memoryCard.innerHTML = `
                    <div class="image-container aspect-[4/3]">
                        <img src="${photo.url}" alt="Memory" class="w-full h-full object-cover" onerror="this.onerror=null;this.src='https://placehold.co/800x600/e2e8f0/475569?text=Image+Not+Found';">
                    </div>
                    <div class="p-4 text-center">
                        <p class="font-display text-purple-800 text-lg">${photo.caption}</p>
                    </div>
                `;
                memoriesGrid.appendChild(memoryCard);
            });

            let musicPlaying = false;
            musicToggle.addEventListener('click', () => {
                if (!config.audioSrc) return;
                if (musicPlaying) {
                    bgMusic.pause();
                    musicIcon.className = 'fas fa-volume-mute';
                } else {
                    bgMusic.play().catch(e => console.log("Audio play failed."));
                    musicIcon.className = 'fas fa-volume-up';
                }
                musicPlaying = !musicPlaying;
            });

            // Animated Decorations & Easter Eggs
            const popSound = new Tone.MembraneSynth().toDestination();
            function createDecorations() {
                const hearts = 15;
                for (let i = 0; i < hearts; i++) {
                    const heart = document.createElement('div');
                    heart.className = 'decoration';
                    heart.style.pointerEvents = 'auto';
                    heart.innerHTML = `<svg class="w-full h-full" viewBox="0 0 24 24" fill="rgba(236, 72, 153, 0.5)"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>`;
                    const size = Math.random() * 40 + 20;
                    heart.style.width = `${size}px`;
                    heart.style.height = `${size}px`;
                    heart.style.left = `${Math.random() * 100}%`;
                    heart.style.animationDelay = `${Math.random() * 20}s`;
                    heart.style.animationDuration = `${Math.random() * 15 + 15}s`;
                    
                    heart.addEventListener('click', (e) => {
                        if (Tone.context.state !== 'running') {
                            Tone.context.resume();
                        }
                        popSound.triggerAttackRelease("C2", "8n");
                        createMiniConfetti(e.clientX, e.clientY);
                        heart.style.display = 'none';
                    });

                    decorationContainer.appendChild(heart);
                }
            }
            createDecorations();

            //Background Particles (hearts)
            function createParticles() {
                for (let i = 0; i < 40; i++) {
                    const particle = document.createElement('div');
                    particle.className = 'particle';
                    const size = Math.random() * 8 + 2;
                    particle.style.width = `${size}px`;
                    particle.style.height = `${size}px`;
                    particle.style.left = `${Math.random() * 100}%`;
                    particle.style.top = `${Math.random() * 100 + 100}%`;
                    particle.style.animationDelay = `${Math.random() * 15}s`;
                    particle.style.animationDuration = `${Math.random() * 10 + 10}s`;
                    particle.style.opacity = Math.random() * 0.5 + 0.2;
                    particleContainer.appendChild(particle);
                }
            }
            createParticles();

            // Main Reveal Animation
            mysteryBtn.addEventListener('click', () => {
                gsap.to(mysteryContainer, {
                    opacity: 0,
                    duration: 1,
                    ease: 'power2.inOut',
                    onComplete: () => {
                        mysteryContainer.style.display = 'none';
                        launchConfetti();
                        if (!musicPlaying && musicToggle && config.audioSrc)
                            musicToggle.click();
                    },
                });
                gsap.to(content, { opacity: 1, duration: 1, delay: 0.5 });

                const tl = gsap.timeline({ delay: 0.8 });
                tl.from('#main-title', {
                    y: 100,
                    opacity: 0,
                    duration: 1,
                    ease: 'power3.out',
                })
                    .from(
                        '#main-subtitle',
                        { y: 50, opacity: 0, duration: 0.8, ease: 'power3.out' },
                        '-=0.7'
                    )
                    .from(
                        '.fa-arrow-down',
                        { y: -20, opacity: 0, duration: 1, ease: 'elastic.out(1, 0.5)' },
                        '-=0.5'
                    );
            });

            //Scroll-Based Animations for mem card
            gsap.utils.toArray('.memory-card').forEach((item) => {
                gsap.from(item, {
                    opacity: 0,
                    y: 100,
                    duration: 1,
                    ease: 'power3.out',
                    scrollTrigger: {
                        trigger: item,
                        start: 'top 85%',
                        toggleActions: 'play none none none',
                    },
                });
            });

            // Wishes Wall Animation
            let wishInterval;
            function createWish() {
                const wishIndex = Math.floor(Math.random() * config.wishes.length);
                const wish = config.wishes[wishIndex];

                const note = document.createElement('div');
                note.className = 'wish-note';
                note.textContent = wish;
                document.getElementById('wishes-wall').appendChild(note);

                gsap.set(note, {
                    x: '-50%',
                    left: `${gsap.utils.random(10, 90)}%`,
                    y: 100,
                    opacity: 0,
                    scale: Math.random() * 0.5 + 0.8,
                });

                gsap.to(note, {
                    y: -window.innerHeight - 150,
                    opacity: 1,
                    duration: Math.random() * 10 + 15,
                    ease: 'linear',
                    onComplete: () => note.remove(),
                });
            }

            ScrollTrigger.create({
                trigger: '#wishes-wall',
                start: 'top 80%',
                end: 'bottom top',
                onEnter: () => {
                    if (!wishInterval) {
                        createWish();
                        wishInterval = setInterval(createWish, 2000);
                    }
                },
                onLeave: () => {
                    clearInterval(wishInterval);
                    wishInterval = null;
                },
                onEnterBack: () => {
                    if (!wishInterval) {
                        createWish();
                        wishInterval = setInterval(createWish, 2000);
                    }
                },
                onLeaveBack: () => {
                    clearInterval(wishInterval);
                    wishInterval = null;
                },
            });

            // Typewriter Animation
            const typewriterContainer = document.getElementById('typewriter-container');
            const messageLines = [
                `Dearest ${config.name},`,
                config.message.p1,
                config.message.p2,
            ];

            ScrollTrigger.create({
                trigger: '#message-box',
                start: 'top 70%',
                onEnter: () => {
                    let masterTl = gsap.timeline();
                    messageLines.forEach((line, i) => {
                        const p = document.createElement('p');
                        p.className = 'text-xl leading-relaxed mb-6 typewriter-cursor';
                        typewriterContainer.appendChild(p);
                        masterTl.to(p, {
                            duration: line.length * 0.05,
                            text: {
                                value: line,
                            },
                            ease: 'none',
                            onComplete: () => p.classList.remove('typewriter-cursor'),
                        });
                    });
                    masterTl
                        .to('#signature', {
                            text: config.message.signature,
                            duration: 1,
                            opacity: 1,
                        })
                        .to(
                            '#from',
                            { text: config.message.from, duration: 1, opacity: 1 },
                            '-=0.5'
                        );
                },
                once: true,
            });

            //Confetti Logic
            const ctx = confettiCanvas.getContext('2d');
            function launchConfetti() {}
            function createMiniConfetti(x, y) {}

            function launchConfetti() {
                createConfettiBurst(
                    window.innerWidth / 2,
                    window.innerHeight / 2,
                    300,
                    true
                );
            }
            function createMiniConfetti(x, y) {
                createConfettiBurst(x, y, 50, false);
            }

            function createConfettiBurst(
                startX,
                startY,
                particleCount,
                isFullScreen
            ) {
                const particles = [];
                const colors = [
                    '#a855f7',
                    '#d946ef',
                    '#ec4899',
                    '#fef08a',
                    '#ffffff',
                ];
                for (let i = 0; i < particleCount; i++) {
                    const angle = Math.random() * Math.PI * 2;
                    const velocity = Math.random() * (isFullScreen ? 8 : 4) + 2;
                    particles.push({
                        x: startX,
                        y: startY,
                        color: colors[Math.floor(Math.random() * colors.length)],
                        radius: Math.random() * 4 + 2,
                        vx: Math.cos(angle) * velocity,
                        vy: Math.sin(angle) * velocity,
                        gravity: 0.1,
                        opacity: 1,
                        fade: Math.random() * 0.02 + 0.01,
                    });
                }
                animateConfetti(particles);
            }

            function animateConfetti(particles) {
                confettiCanvas.width = window.innerWidth;
                confettiCanvas.height = window.innerHeight;

                function update() {
                    ctx.clearRect(0, 0, confettiCanvas.width, confettiCanvas.height);
                    particles.forEach((p, index) => {
                        p.vy += p.gravity;
                        p.x += p.vx;
                        p.y += p.vy;
                        p.opacity -= p.fade;
                        if (p.opacity <= 0) particles.splice(index, 1);
                        else {
                            ctx.globalAlpha = p.opacity;
                            ctx.fillStyle = p.color;
                            ctx.beginPath();
                            ctx.arc(p.x, p.y, p.radius, 0, Math.PI * 2);
                            ctx.fill();
                        }
                    });
                    if (particles.length > 0) requestAnimationFrame(update);
                }
                update();
            }

            window.addEventListener('resize', () => {
                confettiCanvas.width = window.innerWidth;
                confettiCanvas.height = window.innerHeight;
            });
        });
    </script>
</body>
</html>